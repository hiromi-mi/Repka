<% provide(:title, 'Index') %>
<script>
$(function(){
  initializePiecesTable([
    ['id'],
    ['title', 'text'],
    ['teacher', 'text'],
    ['year', 'text'],
    ['kind', 'text'],
    ['data'],
    <% if is_power_ge?(power_of(:shiketai)) %>['operation'],<% end %>
  ]);
});

</script>
<div class="jumbotron">
  <h1>Repka</h1>
  <p>ぼくのかんがえたさいきょうの講義過去問管理検索システム</p>
</div>

<%= render 'pieces/management' %>

<div class="item" id="search">
  <h2>けんさくけんさくぅっ↑</h2>
  <table>
    <tbody>
      <% rows = ['授業名', '講師', '年度', '種別'].each_with_index do |row, index| %>
        <tr>
          <td class="row_name"><%= "#{row}" %></td>
          <td id="col<%= "#{index + 1}" %>_filter"></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>

<div class="item" id="pieces">
  <h2>一覧</h2>
  <table id="pieces_table" class="table table-striped table-bordered" data-source="<%= pieces_path(format: :json)%>">
    <%
      columns = ['ID', '授業名', '講師', '年度', '種別', '']
      columns.push('') if is_power_ge?(power_of(:shiketai))
      ths = columns.map { |v| "<th>#{v}</th>" }.join
    %>
    <thead><%== ths %></thead>
    <tbody></tbody>
    <tfoot><%== ths %></tfoot>
  </table>
</div>
